name: Scheduled Checks

on:
  schedule:
    # Every monday at 7 AM
    - cron: 0 7 * * 1

jobs:
  update:
    runs-on: ubuntu-latest
    permissions:
      contents: write
      pull-requests: write
    steps:
      - name: Checkout ðŸ›Ž
        uses: actions/checkout@v4

      - name: Update pre-commit Hooks
        uses: vrslev/pre-commit-autoupdate@v1.0.0

      - name: Create Pull Request
        uses: peter-evans/create-pull-request@v6
        # This doesn't currently work for us because it creates the PR but the workflows don't run.
        # TODO: Provide a personal access token as a parameter here, that solves that problem.
        # https://github.com/peter-evans/create-pull-request
        with:
          commit-message: "Update pre-commit hooks"
          branch: "fix/update-pre-commit-hooks"
          labels: |
            chore
          delete-branch: true
          base: mealie-next
          title: "chore(auto): Update pre-commit hooks"
          body: "Auto-generated by `.github/workflows/scheduled-checks.yml`"
